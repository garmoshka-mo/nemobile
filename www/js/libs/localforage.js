(function(){"use strict";function e(e){var r=this,n={db:null};if(e)for(var t in e)n[t]=e[t];return new Promise(function(e,t){var o=l.open(n.name,n.version);o.onerror=function(){t(o.error)},o.onupgradeneeded=function(){o.result.createObjectStore(n.storeName)},o.onsuccess=function(){n.db=o.result,r._dbInfo=n,e()}})}function r(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new Promise(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(e);a.onsuccess=function(){var e=a.result;void 0===e&&(e=null),r(e)},a.onerror=function(){t(a.error)}})["catch"](t)});return f(t,r),t}function n(e,r){var n=this,t=new Promise(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor();a.onsuccess=function(){var n=a.result;if(n){var t=e(n.value,n.key);void 0!==t?r(t):n["continue"]()}else r()},a.onerror=function(){t(a.error)}})["catch"](t)});return f(t,r),t}function t(e,r,n){var t=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new Promise(function(n,o){t.ready().then(function(){var i=t._dbInfo,a=i.db.transaction(i.storeName,"readwrite"),u=a.objectStore(i.storeName);null===r&&(r=void 0);var c=u.put(r,e);a.oncomplete=function(){void 0===r&&(r=null),n(r)},a.onabort=a.onerror=function(){o(c.error)}})["catch"](o)});return f(o,n),o}function o(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new Promise(function(r,t){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),u=a["delete"](e);i.oncomplete=function(){r()},i.onerror=function(){t(u.error)},i.onabort=function(e){var r=e.target.error;"QuotaExceededError"===r&&t(r)}})["catch"](t)});return f(t,r),t}function i(e){var r=this,n=new Promise(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readwrite"),i=o.objectStore(t.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){n(a.error)}})["catch"](n)});return f(n,e),n}function a(e){var r=this,n=new Promise(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}})["catch"](n)});return s(n,e),n}function u(e,r){var n=this,t=new Promise(function(r,t){return 0>e?void r(null):void n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,u=i.openCursor();u.onsuccess=function(){var n=u.result;return n?void(0===e?r(n.key):a?r(n.key):(a=!0,n.advance(e))):void r(null)},u.onerror=function(){t(u.error)}})["catch"](t)});return s(t,r),t}function c(e){var r=this,n=new Promise(function(e,n){r.ready().then(function(){var t=r._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var r=i.result;return r?(a.push(r.key),void r["continue"]()):void e(a)},i.onerror=function(){n(i.error)}})["catch"](n)});return s(n,e),n}function s(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}function f(e,r){r&&e.then(function(e){d(r,e)},function(e){r(e)})}function d(e,r){return e?setTimeout(function(){return e(null,r)},0):void 0}window.Promise=RSVP.Promise;var l=l||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(l){var v={_driver:"asyncStorage",_initStorage:e,iterate:n,getItem:r,setItem:t,removeItem:o,clear:i,length:a,key:u,keys:c};"function"==typeof define&&define.amd?define("asyncStorage",function(){return v}):"undefined"!=typeof module&&module.exports?module.exports=v:this.asyncStorage=v}}).call(window),function(){"use strict";function e(e){var r=this,n={};if(e)for(var t in e)n[t]=e[t];return n.keyPrefix=n.name+"/",r._dbInfo=n,v.resolve()}function r(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo.keyPrefix,n=y.length-1;n>=0;n--){var t=y.key(n);0===t.indexOf(e)&&y.removeItem(t)}});return l(n,e),n}function n(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo,t=y.getItem(r.keyPrefix+e);return t&&(t=c(t)),t});return l(t,r),t}function t(e,r){var n=this,t=n.ready().then(function(){for(var r=n._dbInfo.keyPrefix,t=r.length,o=y.length,i=0;o>i;i++){var a=y.key(i),u=y.getItem(a);if(u&&(u=c(u)),u=e(u,a.substring(t)),void 0!==u)return u}});return l(t,r),t}function o(e,r){var n=this,t=n.ready().then(function(){var r,t=n._dbInfo;try{r=y.key(e)}catch(o){r=null}return r&&(r=r.substring(t.keyPrefix.length)),r});return l(t,r),t}function i(e){var r=this,n=r.ready().then(function(){for(var e=r._dbInfo,n=y.length,t=[],o=0;n>o;o++)0===y.key(o).indexOf(e.keyPrefix)&&t.push(y.key(o).substring(e.keyPrefix.length));return t});return l(n,e),n}function a(e){var r=this,n=r.keys().then(function(e){return e.length});return l(n,e),n}function u(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=n.ready().then(function(){var r=n._dbInfo;y.removeItem(r.keyPrefix+e)});return l(t,r),t}function c(e){if(e.substring(0,b)!==g)return JSON.parse(e);for(var r=e.substring(O),n=e.substring(b,O),t=new ArrayBuffer(2*r.length),o=new Uint16Array(t),i=r.length-1;i>=0;i--)o[i]=r.charCodeAt(i);switch(n){case p:return t;case m:return new Blob([t]);case w:return new Int8Array(t);case S:return new Uint8Array(t);case I:return new Uint8ClampedArray(t);case _:return new Int16Array(t);case A:return new Uint16Array(t);case E:return new Int32Array(t);case k:return new Uint32Array(t);case x:return new Float32Array(t);case N:return new Float64Array(t);default:throw new Error("Unkown type: "+n)}}function s(e){var r="",n=new Uint16Array(e);try{r=String.fromCharCode.apply(null,n)}catch(t){for(var o=0;o<n.length;o++)r+=String.fromCharCode(n[o])}return r}function f(e,r){var n="";if(e&&(n=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var t,o=g;e instanceof ArrayBuffer?(t=e,o+=p):(t=e.buffer,"[object Int8Array]"===n?o+=w:"[object Uint8Array]"===n?o+=S:"[object Uint8ClampedArray]"===n?o+=I:"[object Int16Array]"===n?o+=_:"[object Uint16Array]"===n?o+=A:"[object Int32Array]"===n?o+=E:"[object Uint32Array]"===n?o+=k:"[object Float32Array]"===n?o+=x:"[object Float64Array]"===n?o+=N:r(new Error("Failed to get type for BinaryArray"))),r(o+s(t))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var e=s(this.result);r(g+m+e)},i.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(a){window.console.error("Couldn't convert value into a JSON string: ",e),r(a)}}function d(e,r,n){var t=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=t.ready().then(function(){void 0===r&&(r=null);var n=r;return f(r,function(r,n){if(n)throw n;try{var o=t._dbInfo;y.setItem(o.keyPrefix+e,r)}catch(i){if("QuotaExceededError"===i.name||"NS_ERROR_DOM_QUOTA_REACHED"===i.name)throw i}}),n});return l(o,n),o}function l(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}var v="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,y=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;y=this.localStorage}catch(h){return}var g="__lfsc__:",b=g.length,p="arbf",m="blob",w="si08",S="ui08",I="uic8",_="si16",E="si32",A="ur16",k="ui32",x="fl32",N="fl64",O=b+p.length,D={_driver:"localStorageWrapper",_initStorage:e,iterate:t,getItem:n,setItem:d,removeItem:u,clear:r,length:a,key:o,keys:i};"function"==typeof define&&define.amd?define("localStorageWrapper",function(){return D}):"undefined"!=typeof module&&module.exports?module.exports=D:this.localStorageWrapper=D}.call(window),function(){"use strict";function e(e){var r=this,n={db:null};if(e)for(var t in e)n[t]="string"!=typeof e[t]?e[t].toString():e[t];return new y(function(t,o){try{n.db=h(n.name,String(n.version),n.description,n.size)}catch(i){return r.setDriver("localStorageWrapper").then(function(){return r._initStorage(e)}).then(t)["catch"](o)}n.db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){r._dbInfo=n,t()},function(e,r){o(r)})})})}function r(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new y(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var t=n.rows.length?n.rows.item(0).value:null;t&&(t=f(t)),r(t)},function(e,r){t(r)})})})["catch"](t)});return l(t,r),t}function n(e,r){var n=this,t=new y(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,t){for(var o=t.rows,i=o.length,a=0;i>a;a++){var u=o.item(a),c=u.value;if(c&&(c=f(c)),c=e(c,u.key),void 0!==c)return void r(c)}r()},function(e,r){t(r)})})})["catch"](t)});return l(t,r),t}function t(e,r,n){var t=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var o=new y(function(n,o){t.ready().then(function(){void 0===r&&(r=null);var i=r;d(r,function(r,a){if(a)o(a);else{var u=t._dbInfo;u.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,r],function(){n(i)},function(e,r){o(r)})},function(e){e.code===e.QUOTA_ERR&&o(e)})}})})["catch"](o)});return l(o,n),o}function o(e,r){var n=this;"string"!=typeof e&&(window.console.warn(e+" used as a key, but it is not a string."),e=String(e));var t=new y(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){r()},function(e,r){t(r)})})})["catch"](t)});return l(t,r),t}function i(e){var r=this,n=new y(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("DELETE FROM "+t.storeName,[],function(){e()},function(e,r){n(r)})})})["catch"](n)});return l(n,e),n}function a(e){var r=this,n=new y(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("SELECT COUNT(key) as c FROM "+t.storeName,[],function(r,n){var t=n.rows.item(0).c;e(t)},function(e,r){n(r)})})})["catch"](n)});return l(n,e),n}function u(e,r){var n=this,t=new y(function(r,t){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var t=n.rows.length?n.rows.item(0).key:null;r(t)},function(e,r){t(r)})})})["catch"](t)});return l(t,r),t}function c(e){var r=this,n=new y(function(e,n){r.ready().then(function(){var t=r._dbInfo;t.db.transaction(function(r){r.executeSql("SELECT key FROM "+t.storeName,[],function(r,n){for(var t=[],o=0;o<n.rows.length;o++)t.push(n.rows.item(o).key);e(t)},function(e,r){n(r)})})})["catch"](n)});return l(n,e),n}function s(e){var r,n=new Uint8Array(e),t="";for(r=0;r<n.length;r+=3)t+=v[n[r]>>2],t+=v[(3&n[r])<<4|n[r+1]>>4],t+=v[(15&n[r+1])<<2|n[r+2]>>6],t+=v[63&n[r+2]];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function f(e){if(e.substring(0,b)!==g)return JSON.parse(e);var r,n,t,o,i,a=e.substring(O),u=e.substring(b,O),c=.75*a.length,s=a.length,f=0;"="===a[a.length-1]&&(c--,"="===a[a.length-2]&&c--);var d=new ArrayBuffer(c),l=new Uint8Array(d);for(r=0;s>r;r+=4)n=v.indexOf(a[r]),t=v.indexOf(a[r+1]),o=v.indexOf(a[r+2]),i=v.indexOf(a[r+3]),l[f++]=n<<2|t>>4,l[f++]=(15&t)<<4|o>>2,l[f++]=(3&o)<<6|63&i;switch(u){case p:return d;case m:return new Blob([d]);case w:return new Int8Array(d);case S:return new Uint8Array(d);case I:return new Uint8ClampedArray(d);case _:return new Int16Array(d);case A:return new Uint16Array(d);case E:return new Int32Array(d);case k:return new Uint32Array(d);case x:return new Float32Array(d);case N:return new Float64Array(d);default:throw new Error("Unkown type: "+u)}}function d(e,r){var n="";if(e&&(n=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var t,o=g;e instanceof ArrayBuffer?(t=e,o+=p):(t=e.buffer,"[object Int8Array]"===n?o+=w:"[object Uint8Array]"===n?o+=S:"[object Uint8ClampedArray]"===n?o+=I:"[object Int16Array]"===n?o+=_:"[object Uint16Array]"===n?o+=A:"[object Int32Array]"===n?o+=E:"[object Uint32Array]"===n?o+=k:"[object Float32Array]"===n?o+=x:"[object Float64Array]"===n?o+=N:r(new Error("Failed to get type for BinaryArray"))),r(o+s(t))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var e=s(this.result);r(g+m+e)},i.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(a){window.console.error("Couldn't convert value into a JSON string: ",e),r(null,a)}}function l(e,r){r&&e.then(function(e){r(null,e)},function(e){r(e)})}var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,h=this.openDatabase,g="__lfsc__:",b=g.length,p="arbf",m="blob",w="si08",S="ui08",I="uic8",_="si16",E="si32",A="ur16",k="ui32",x="fl32",N="fl64",O=b+p.length;if(h){var D={_driver:"webSQLStorage",_initStorage:e,iterate:n,getItem:r,setItem:t,removeItem:o,clear:i,length:a,key:u,keys:c};"function"==typeof define&&define.amd?define("webSQLStorage",function(){return D}):"undefined"!=typeof module&&module.exports?module.exports=D:this.webSQLStorage=D}}.call(window),function(){"use strict";function e(e,r){e[r]=function(){var n=arguments;return e.ready().then(function(){return e[r].apply(e,n)})}}function r(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var n in r)r.hasOwnProperty(n)&&(arguments[0][n]=v(r[n])?r[n].slice():r[n])}return arguments[0]}function n(e){for(var r in a)if(a.hasOwnProperty(r)&&a[r]===e)return!0;return!1}function t(n){this._config=r({},f,n),this._driverSet=null,this._ready=!1,this._dbInfo=null;for(var t=0;t<c.length;t++)e(this,c[t]);this.setDriver(this._config.driver)}var o="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,i={},a={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},u=[a.INDEXEDDB,a.WEBSQL,a.LOCALSTORAGE],c=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],s={DEFINE:1,EXPORT:2,WINDOW:3},f={description:"",driver:u.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},d=s.WINDOW;"function"==typeof define&&define.amd?d=s.DEFINE:"undefined"!=typeof module&&module.exports&&(d=s.EXPORT);var l=function(e){var r=r||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB,n={};return n[a.WEBSQL]=!!e.openDatabase,n[a.INDEXEDDB]=!!function(){if("undefined"!=typeof e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent))return!1;try{return r&&"function"==typeof r.open&&"undefined"!=typeof e.IDBKeyRange}catch(n){return!1}}(),n[a.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(r){return!1}}(),n}(this),v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},y=this;t.prototype.INDEXEDDB=a.INDEXEDDB,t.prototype.LOCALSTORAGE=a.LOCALSTORAGE,t.prototype.WEBSQL=a.WEBSQL,t.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var r in e)"storeName"===r&&(e[r]=e[r].replace(/\W/g,"_")),this._config[r]=e[r];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},t.prototype.defineDriver=function(e,r,t){var a=new o(function(r,t){try{var a=e._driver,u=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),s=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void t(u);if(n(e._driver))return void t(s);for(var f=c.concat("_initStorage"),d=0;d<f.length;d++){var v=f[d];if(!v||!e[v]||"function"!=typeof e[v])return void t(u)}var y=o.resolve(!0);"_support"in e&&(y=e._support&&"function"==typeof e._support?e._support():o.resolve(!!e._support)),y.then(function(n){l[a]=n,i[a]=e,r()},t)}catch(h){t(h)}});return a.then(r,t),a},t.prototype.driver=function(){return this._driver||null},t.prototype.ready=function(e){var r=this,n=new o(function(e,n){r._driverSet.then(function(){null===r._ready&&(r._ready=r._initStorage(r._config)),r._ready.then(e,n)})["catch"](n)});return n.then(e,e),n},t.prototype.setDriver=function(e,r,t){function a(){u._config.driver=u.driver()}var u=this;return"string"==typeof e&&(e=[e]),this._driverSet=new o(function(r,t){var a=u._getFirstSupportedDriver(e),c=new Error("No available storage method found.");if(!a)return u._driverSet=o.reject(c),void t(c);if(u._dbInfo=null,u._ready=null,n(a)){if(d===s.DEFINE)return void require([a],function(e){u._extend(e),r()});if(d===s.EXPORT){var f;switch(a){case u.INDEXEDDB:f=require("./drivers/indexeddb");break;case u.LOCALSTORAGE:f=require("./drivers/localstorage");break;case u.WEBSQL:f=require("./drivers/websql")}u._extend(f)}else u._extend(y[a])}else{if(!i[a])return u._driverSet=o.reject(c),void t(c);u._extend(i[a])}r()}),this._driverSet.then(a,a),this._driverSet.then(r,t),this._driverSet},t.prototype.supports=function(e){return!!l[e]},t.prototype._extend=function(e){r(this,e)},t.prototype._getFirstSupportedDriver=function(e){if(e&&v(e))for(var r=0;r<e.length;r++){var n=e[r];if(this.supports(n))return n}return null},t.prototype.createInstance=function(e){return new t(e)};var h=new t;d===s.DEFINE?define("localforage",function(){return h}):d===s.EXPORT?module.exports=h:this.localforage=h}.call(window);