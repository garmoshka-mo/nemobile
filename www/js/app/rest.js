function onLoad(){angular.bootstrap(document,["angApp"])}var app=angular.module("angApp",["ui.router","angControllers","angServices","angFactories","mm.foundation","LocalForageModule","ngTouch","ngSanitize","angular-gestures","angularFileUpload","internationalPhoneNumber"]);app.config(["$animateProvider","$compileProvider",function(t,e){t.classNameFilter(/^(?:(?!ng-animate-disabled).)*$/),e.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|content):|data:image\//)}]),angular.module("angApp").config(function(t){t.state("start",{url:"",views:{title:{template:"Чат 0.0.1"},menu:{templateUrl:"partials/start/menu.html"},content:{templateUrl:"partials/start/content.html",controller:"startController"}}}).state("signin",{url:"/signinup/:inOrUp",views:{title:{template:""},menu:{templateUrl:"partials/start/menu.html"},content:{controller:"signinupController",templateUrl:"partials/signinup/content.html"}}}).state("signup",{url:"/signup",views:{title:{template:"Регистрация"},menu:{templateUrl:"partials/start/menu.html"},content:{controller:"registrationController",templateUrl:"partials/signup/content.html"}}}).state("chats",{url:"/chats",views:{title:{template:"Чаты"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"chatsController",templateUrl:"partials/chats/content.html"}}}).state("chat",{url:"/chat?senderId&messageText",views:{title:{template:"Чат"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"chatController",templateUrl:"partials/chat/content.html"}}}).state("exit",{url:"/exit",views:{title:{template:"Выход"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"exitController",templateUrl:"partials/exit/content.html"}}}).state("friendSearch",{url:"/friendSearch",views:{title:{template:"Поиск друзей"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"friendSearchController",templateUrl:"partials/friendSearch/content.html"}}}).state("localForage",{url:"/localForage",views:{title:{template:"Local Forage Test"},menu:{templateUrl:"partials/start/menu.html"},content:{controller:"localForageController",templateUrl:"partials/localForage/content.html"}}}).state("stickersGallery",{url:"/stickersGallery?fromChat",views:{title:{template:"Галерея стикеров"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"stickersGalleryController",templateUrl:"partials/stickersGallery/content.html"}}}).state("addImage",{url:"/addImage?imageURL&categoryId",views:{title:{template:"Добавить изображение"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"addImageController",templateUrl:"partials/addImage/content.html"}}}).state("friends",{url:"/friends",views:{title:{template:"Друзья"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"friendsController",templateUrl:"partials/friends/content.html"}}}).state("phoneRegistration",{url:"/phoneRegistration",views:{title:{template:"Регистрация номера"},menu:{templateUrl:"partials/start/menu.html"},content:{controller:"phoneRegistrationController",templateUrl:"partials/phoneRegistration/content.html"}}}).state("phoneRegistrationUser",{url:"/phoneRegistrationUser",views:{title:{template:"Регистрация номера"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"phoneRegistrationUserController",templateUrl:"partials/phoneRegistrationUser/content.html"}}}).state("settings",{url:"/settings",views:{title:{template:"Настройки"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"settingsController",templateUrl:"partials/settings/content.html"}}}).state("invitation",{url:"/invitation?friendIndex",views:{title:{template:"Приглашение"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"invitationController",templateUrl:"partials/invitation/content.html"}}}).state("loadAvatar",{url:"/loadAvatar",views:{title:{template:"Загрузка аватарки"},menu:{templateUrl:"partials/chats/menu.html"},content:{controller:"loadAvatarController",templateUrl:"partials/loadAvatar/content.html"}}})});var pushNotification;document.addEventListener("deviceready",function(){function t(t){console.log(t)}function e(){console.log(result)}function n(t){window.webViewShrinker.shrink(t.keyboardHeight)}function i(){window.webViewShrinker.unshrink()}function o(t){window.deviceId=t,window.registerDeviceToChannel(t)}function e(t){alert(t)}if(console.log(">>>>>>>>>>>>>>>>>>>DEVICE READY"),pushNotification=window.plugins.pushNotification,"iOS"==device.platform){var r=new CustomEvent("webViewShrunk");window.webViewShrinker={normalHeight:null,shrink:function(t){this.normalHeight||(this.normalHeight=$("body").height()),$("body").height(this.normalHeight-t),$("#footer").css("position","relative"),document.dispatchEvent(r)},unshrink:function(){$("body").height(this.normalHeight),$("#footer").css("position","fixed")}},cordova.plugins.Keyboard.disableScroll(!0),cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.addEventListener("native.keyboardshow",n),window.addEventListener("native.keyboardhide",i),pushNotification.register(o,e,{badge:"true",sound:"true",alert:"true",ecb:"onNotificationAPN"}),window.onNotificationAPN=function(t){return console.log("apn notification",t),"0"!==t.foreground||window.isGotUnseenMessage?void("0"===t.foreground&&(location.href="#/chat?senderId="+t.uuid)):void(window.goToLastMessageChat=!0)}}("android"==device.platform||"Android"==device.platform||"amazon-fireos"==device.platform)&&(pushNotification.register(t,e,{senderID:"1176989379",ecb:"onNotificationGCM"}),window.onNotificationGCM=function(t){console.log(t),"registered"==t.event?(window.deviceId=t.regid,registerDeviceToChannel()):t.coldstart?window.goToLastMessageChat=!0:t.foreground||(location.href="#/chat?senderId="+t.payload.uuid)})}),angular.module("angControllers",[]);var services=angular.module("angServices",[]),factories=angular.module("angFactories",[]);app.directive("stopEvent",function(){return{restrict:"A",link:function(t,e){e.bind("click touchstart",function(t){t.stopPropagation()})}}}),app.directive("stopEventPrevent",function(){return{restrict:"A",link:function(t,e){e.bind("click touchstart",function(t){t.stopPropagation(),t.preventDefault()})}}}),app.directive("overscrollableWithFooter",function(){return{link:function(t,e){$(e).css({height:"100%",width:"100%","padding-right":"15px","box-sizing":"content-box",overflow:"auto"})}}}),app.directive("overscrollableWithoutFooter",function(){return{link:function(t,e){var n=getEmPixels(),i=$("body").height(),o=2.8125;$(e).height(i-n*o),$(e).css({width:"100%","padding-right":"15px","box-sizing":"content-box",overflow:"auto"})}}}),app.directive("imageonload",function(){return{restrict:"A",link:function(t,e,n){e.bind("load",function(){t.$apply(n.imageonload)})}}}),app.directive("npTouchstart",function(){return{link:function(t,e,n){$(e).on("click touchstart",function(){t[n.npTouchstart]()})}}}),app.directive("stickersGalleryHeight",function(){return{link:function(t,e){var n=getEmPixels(),i=$("body").height(),o=2.8125;console.log("top bar height: ",n*o),console.log("chat keyboard height: ",$(".chat-buttons-container").height());var r=72,a=20,l=20,s=i-n*o-r-a;window.device&&"iOS"==device.platform&&(s-=l),$(e).height(s)}}}),app.directive("spinner",function(){return{template:'<div class="spinner"><div class="dot bounce1"></div><div class="dot bounce2"></div><div class="dot bounce3"></div></div>',link:function(t,e,n){var i=$(e).find(".dot");"grey"==n.spinnerColor&&i.addClass("grey"),i.addClass("white"==n.spinnerColor?"white":"black")}}}),app.filter("orderObjectBy",function(){return function(t,e,n){var i=[];return angular.forEach(t,function(t){i.push(t)}),i.sort(function(t,e){return t.isRead===!0&&e.isRead===!1?-1:t.isRead===!1&&e.isRead===!0?1:-1}),n&&i.reverse(),i}}),app.filter("orderByName",function(){return function(t,e,n){var i=[];return angular.forEach(t,function(t){i.push(t)}),i.sort(function(t,e){return t.displayName<e.displayName?-1:1}),n&&i.reverse(),i}});var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){}};window.App={},window.App.Settings={pubnubSubscribeKey:"sub-c-471ba8b8-64a1-11e4-8fde-02ee2ddab7fe",pubnubPublishKey:"demo-36",pubnubSecretKey:"demo-36",pubnubSsl:!1,pubnubOrigin:"pubsub.pubnub.com",pubnubNotificationType:"",pubnubChannelPostfix:"qwer_4321_nepotom",apiUrl:"http://nepotom.herokuapp.com"};